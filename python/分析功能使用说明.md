# 📊 数据分析功能使用说明

## 快速开始

### 方法 1: 使用演示脚本（推荐 ⭐）

最简单的方式，一键生成所有图表：

```bash
cd /home/ben/gemini-work/gemini-t66y/python

# 生成全局统计（所有作者）
python demo_analysis.py

# 生成特定作者的统计
python demo_analysis.py 同花顺心
python demo_analysis.py cyruscc
```

---

## 生成的图表说明

### 1. 📈 月度趋势图
- **文件名**: `monthly_trend_全局.png` 或 `monthly_trend_作者名.png`
- **内容**: 按月统计发帖数量的折线图
- **用途**: 查看发帖趋势，了解活跃度变化

### 2. 🔥 时间热力图
- **文件名**: `time_heatmap_全局.png` 或 `time_heatmap_作者名.png`
- **内容**: 7×24 热力图（星期 × 小时）
- **用途**: 查看哪个时间段最活跃（颜色越深=发帖越多）

### 3. 🔤 词云
- **文件名**: `wordcloud_作者名.png`
- **内容**: 帖子标题的高频词可视化
- **用途**: 快速了解作者的发帖主题
- **注意**: 仅在作者模式下生成（全局模式不支持）

### 4. 📷 相机排行图
- **文件名**: `camera_ranking.png`
- **内容**: 使用最多的相机 Top 10
- **用途**: 查看摄影器材统计
- **注意**: 仅在全局模式下生成

---

## 活跃度指标说明

运行脚本时会输出以下指标：

| 指标 | 说明 |
|------|------|
| **最活跃小时** | 一天中发帖最多的小时（0-23） |
| **最活跃星期** | 一周中发帖最多的星期 |
| **周末占比** | 周六+周日发帖占比 |
| **夜猫子指数** | 22:00-6:00 发帖占比 |
| **早起指数** | 6:00-9:00 发帖占比 |
| **工作日指数** | 周一至周五 9:00-18:00 发帖占比 |

---

## 输出文件位置

所有图表保存在：
```
/home/ben/gemini-work/gemini-t66y/python/data/analysis/
```

可以用以下命令查看：
```bash
ls -lh python/data/analysis/
```

---

## 示例输出

### 全局统计示例

```bash
$ python demo_analysis.py

📌 分析范围: 全局统计

🔤 [1/5] 跳过词云（全局模式不支持词云）
📈 [2/5] 生成月度趋势图...
    ✅ 完成: monthly_trend_global.png
🔥 [3/5] 生成时间热力图...
    ✅ 完成: time_heatmap_global.png
⚡ [4/5] 分析活跃度模式...
    ✅ 完成:
       - 最活跃小时: 16:00
       - 最活跃星期: 周四
       - 周末占比: 25.3%
       - 夜猫子指数: 28.4%
       - 早起指数: 0.0%
       - 工作日指数: 50.7%
📷 [5/5] 生成相机排行图...
    ✅ 完成: camera_ranking.png

✅ 分析完成！生成了 3 个图表
```

### 作者统计示例

```bash
$ python demo_analysis.py 同花顺心

📌 分析作者: 同花顺心

🔤 [1/5] 生成词云...
    ✅ 完成: wordcloud_同花顺心.png
📈 [2/5] 生成月度趋势图...
    ✅ 完成: monthly_trend_同花顺心.png
🔥 [3/5] 生成时间热力图...
    ✅ 完成: time_heatmap_同花顺心.png
⚡ [4/5] 分析活跃度模式...
    ✅ 完成:
       - 最活跃小时: 16:00
       - 最活跃星期: 周五
       - 周末占比: 0.0%
       - 夜猫子指数: 0.0%
       - 早起指数: 0.0%
       - 工作日指数: 61.5%
📷 [5/5] 跳过相机排行图（作者模式不支持相机统计）

✅ 分析完成！生成了 3 个图表
```

---

## 查看作者列表

如果不知道有哪些作者，运行以下命令：

```bash
python -c "
import sys
sys.path.insert(0, 'src')
from src.database.connection import get_default_connection
from src.database.models import Author

db = get_default_connection()
Author._db = db
authors = Author.get_all()
print(f'共 {len(authors)} 个作者:')
for a in authors[:20]:
    print(f'  - {a.name}')
if len(authors) > 20:
    print(f'  ... 还有 {len(authors) - 20} 个作者')
"
```

---

## 常见问题

### Q: 词云中文显示为方框？
**A**: 需要安装中文字体：
```bash
sudo apt install fonts-wqy-zenhei  # Ubuntu/Debian
```

### Q: 提示"作者不存在"？
**A**: 检查作者名是否正确，运行上面的"查看作者列表"命令。

### Q: 生成的图片在哪里？
**A**: 都在 `python/data/analysis/` 目录下。

### Q: 如何查看图片？
**A**: 用任意图片查看器打开 PNG 文件，或者：
```bash
# Linux
eog python/data/analysis/wordcloud_同花顺心.png

# macOS
open python/data/analysis/wordcloud_同花顺心.png
```

---

## 技术细节

- **图片格式**: PNG
- **分辨率**: 300 DPI（高清输出）
- **文件大小**: 40-280 KB
- **图片尺寸**:
  - 词云: 1200×800
  - 月度趋势: 12×6 英寸
  - 时间热力图: 14×6 英寸
  - 相机排行: 10×6 英寸

---

## 下一步

如果您对当前功能满意，我们可以继续实现：
1. **可视化器** - 统一的可视化接口
2. **报告生成器** - 生成包含所有图表的 HTML 报告
3. **分析菜单** - 在主菜单中集成分析功能

---

*生成日期: 2026-02-15*
*作者: Claude Sonnet 4.5*
